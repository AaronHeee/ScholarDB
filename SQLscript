create table USERINFO
(
    UNO INTEGER NOT NULL,
    UNAME VARCHAR(45) NOT NULL,
    MAIL VARCHAR(100),
    BANKNO VARCHAR(45),
    AGE SMALLINT,
    USERTYPE VARCHAR(45),
    GENDER VARCHAR(45),
    NATION VARCHAR(45),
    CITY VARCHAR(45),
    MONEY INTEGER,
    PRIMARY KEY(UNO)
);

create table SCHOLAR(
    UNO INTEGER PRIMARY KEY,
    TYPE VARCHAR(45) ,
    INST VARCHAR(45),
    RATE SMALLINT,
    FOREIGN KEY(UNO) REFERENCES USERINFO(UNO)
);

alter table USERINFO ADD PWD VARCHAR(45);
alter table USERINFO convert to character set utf8;

insert into USERINFO(UNO,UNAME,MAIL,AGE,USERTYPE,GENDER,NATION,CITY,MONEY,PWD)
values (1000,'金熙森','2474010692@qq.com',19,'Scholar','Male','中国','上海',500,'abcdef');
alter table SCHOLAR convert to character set utf8;
insert into SCHOLAR(UNO,TYPE,INST,RATE)
VALUES (1000,'Student','复旦大学',1);

insert into USERINFO(UNO,UNAME,MAIL,AGE,USERTYPE,GENDER,NATION,CITY,MONEY,PWD)
values (1001,'何占魁','15307130175@fudan.edu.cn',19,'Scholar','Male','中国','上海',500,'123456');
alter table SCHOLAR convert to character set utf8;
insert into SCHOLAR(UNO,TYPE,INST,RATE)
VALUES (1001,'Student','复旦大学',1);

create table VOLUNTEER(
    UNO INTEGER PRIMARY KEY,
    CRED SMALLINT,
    FOREIGN KEY(UNO) REFERENCES USERINFO(UNO)
);
alter table VOLUNTEER convert to character set utf8;


/*0413 以下内容建立调研相关的表*/

create table SURVEY(
    SNO INTEGER PRIMARY KEY NOT NULL AUTO_INCREMENT,
    TITLE VARCHAR(200) NOT NULL,
    DESCRIPTION VARCHAR(200),
    MINAGE SMALLINT NOT NULL,
    MAXAGE SMALLINT NOT NULL,
    GENDER_RESTRICT VARCHAR(45) NOT NULL,
    SURVEY_RESTRICT VARCHAR(45) NOT NULL,
    PAYMENT INTEGER NOT NULL,
    STAGE VARCHAR(45) NOT NULL,
    OPENTIME DATETIME NOT NULL
);


create table PRIVACY(
    SNO INTEGER NOT NULL,
    WHAT VARCHAR(45) NOT NULL,
    PRIMARY KEY(SNO,WHAT),
    FOREIGN KEY(SNO) REFERENCES SURVEY(SNO)
);

create table SURVEY_SUBJECT(
    SNO INTEGER NOT NULL,
    WHAT VARCHAR(45) NOT NULL,
    PRIMARY KEY(SNO,WHAT),
    FOREIGN KEY(SNO) REFERENCES SURVEY(SNO)
);

create table SCHOLAR_OWN_SURVEY(
    UNO INTEGER NOT NULL,
    SNO INTEGER NOT NULL,
    ACCESS VARCHAR(45) NOT NULL,
    PRIMARY KEY(UNO,SNO),
    FOREIGN KEY(UNO) REFERENCES USERINFO(UNO),
    FOREIGN KEY(SNO) REFERENCES SURVEY(SNO)
);


/*这里的question表示公共的数据集中的question,不再可以编辑*/
create table QUESTION(
    QNO INTEGER PRIMARY KEY NOT NULL AUTO_INCREMENT,
    SNO INTEGER NOT NULL,
    TITLE VARCHAR(200) NOT NULL,
    SUPPLEMENT VARCHAR(200),
    SUPPLEMENT_TYPE VARCHAR(45),
    TYPE VARCHAR(45) NOT NULL,
    INPUTTYPE VARCHAR(45) NOT NULL,
    FOREIGN KEY(SNO) REFERENCES SURVEY(SNO)
);
/*chocie同理*/
create table CHOICE(
    CNO INTEGER PRIMARY KEY NOT NULL AUTO_INCREMENT,
    PLACE INTEGER NOT NULL,
    QNO INTEGER NOT NULL,
    CONTENT VARCHAR(200)
);

create table TASK(
    TNO INTEGER PRIMARY KEY NOT NULL AUTO_INCREMENT,
    TITLE VARCHAR(200) NOT NULL,
    DESCRIPTION VARCHAR(1000) NOT NULL,
    PAYMENT INTEGER NOT NULL,
    OPENTIME DATETIME NOT NULL,
    DEADLINE DATE NOT NULL
);

create table SCHOLAR_OWN_TASK(
    UNO INTEGER NOT NULL,
    TNO INTEGER NOT NULL,
    ACCESS VARCHAR(45),
    PRIMARY KEY(TNO),
    FOREIGN KEY(UNO) REFERENCES USERINFO(UNO),
    FOREIGN KEY(TNO) REFERENCES TASK(TNO)
);

create table FILE(
    FNO INTEGER PRIMARY KEY NOT NULL AUTO_INCREMENT,
    FNAME VARCHAR(100),
    RAWDATA VARCHAR(100) NOT NULL,
    EXAMPLE VARCHAR(100),
    TYPE VARCHAR(20),
    NUM INTEGER NOT NULL,
    NOW INTEGER NOT NULL
);

create table TASK_WITH_FILE(
    TNO INTEGER NOT NULL,
    FNO INTEGER NOT NULL,
    PRIMARY KEY(TNO),
    FOREIGN KEY(TNO) REFERENCES TASK(TNO),
    FOREIGN KEY(FNO) REFERENCES FILE(FNO)
);

alter table QUESTION convert to character set utf8;
alter table CHOICE convert to character set utf8;
alter table SCHOLAR_OWN_SURVEY convert to character set utf8;
alter table SURVEY convert to character set utf8;
alter table SURVEY_SUBJECT convert to character set utf8;
alter table PRIVACY convert to character set utf8;
alter table TASK convert to character set utf8;
alter table QUESTION drop INPUTTYPE cascade;
alter table SCHOLAR_OWN_TASK convert to character set utf8;
alter table FILE convert to character set utf8;
alter table TASK_WITH_FILE convert to character set utf8;

alter table QUESTION drop INPUTTYPE cascade

create table ANSWER(
    QNO INTEGER NOT NULL,
    VALUE VARCHAR(200) NOT NULL,
    UNO INTEGER NOT NULL,
    FOREIGN KEY(QNO) REFERENCES QUESTION(QNO),
    FOREIGN KEY(UNO) REFERENCES USERINFO(UNO)
);

create table PARTICIPATION(
    SNO INTEGER NOT NULL,
    UNO INTEGER NOT NULL,
    TIME_CONSUMED INTEGER,
    SUBMIT_TIME DATETIME,
    STATUS VARCHAR(45),
    FOREIGN KEY(SNO) REFERENCES SURVEY(SNO),
    FOREIGN KEY(UNO) REFERENCES USERINFO(UNO)
);

alter table ANSWER convert to character set utf8;


/*0423*/
alter table SURVEY add TYPE VARCHAR(20);
alter table TASK add TYPE VARCHAR(20);
/*0427*/

drop table PARTICIPATION /*不知道怎么删外键……各种报错*/
create table PARTICIPATION(
    SNO INTEGER NOT NULL,
    UNO INTEGER NOT NULL,
    TIME_CONSUMED INTEGER,
    SUBMIT_TIME DATETIME,
    STATUS VARCHAR(45),
    FOREIGN KEY(UNO) REFERENCES USERINFO(UNO)
);

create table PUBLICITY_SURVEY(
    SNO INTEGER NOT NULL PRIMARY KEY,
    PUBLICITY VARCHAR(45),
    FOREIGN KEY(SNO) REFERENCES SURVEY(SNO)
);

create table PARTICIPATION_TASK(
    TNO INTEGER NOT NULL,
    UNO INTEGER NOT NULL,
    SUBMIT_TIME DATETIME,
    STATUS VARCHAR(45),
    FOREIGN KEY(UNO) REFERENCES USERINFO(UNO)
)